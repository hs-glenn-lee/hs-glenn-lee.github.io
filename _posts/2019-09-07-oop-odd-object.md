---
layout: post
title:  "이상한 나라의 객체"
author: "이희수"
---


# 객체지향과 인지 능력

아기와 막대기 심리실험의 결과는 "사람이 선천적으로 뚜렷한 경계를 가지고 함께 행동하는 물체를 하나의 개념으로 인지한다는 사실을 알수있다"라는 것을 증명했다. 이는 사람의 인지능력이 다양한 객체를 식별하고 분류한다는 것을 의미한다. 사람은 세상을 객체의 집합으로 바라본다.

실험 결과 뿐만 아니라, 개발자의 커뮤니케이션에서도 인지의 특징을 살펴 볼 수 있다. 당연하고 자연스럽게 "서버가 다운됐다." "유저가 탈퇴 상태다." "장바구니 기능을 개발해야 하고, 장바구니는 사용자가 구매를 원하는 상품을 임시적으로 담아 놓는다." 장바구니 기능을 구현하려면, 실세계의 장바구니와 비슷한 역할을 하는 온라인 쇼핑몰 시스템에 보이지 않는 물체를 구현하는 것이다. 이처럼 자연스럽게 코드가 아닌 추상화 된 개념으로 이야기를 많이 한다. (장바구니는 객체다.)

세상을 더 작은 객체로 분해하는 것은 세상의 복잡성을 이해하기 위한 인간의 작은 몸부림이다. 사람은 주변을 객체로 분해하고 이해하려고 노력한다. 객체란 인간이 분명하게 인지하고 구별할 수 있는 물리적인 또는 개념적인 경계를 지닌 어떤 것이다.

* 입/출금 예시 -> 식별성, 인지능력

# 객체, 그리고 이상한 나라

앞서 객체지향 프로그래밍은 실세계의 모방이 아닌 새로운 세계를 창조하는 것이라고 했다. 새로운 세계는 상식과 다르다. 작가가 이상한 나라의 엘리스로 예를 들어 설명하는 것은 이런 맥락의 은유로 보인다.

"엘리스는 키가 작아지는 음료를 마시면 키가 120cm 작아지고, 케이크를 먹으면 키가 3m 커진다."

"150cm 였던 엘리스는 음료를 먹으면 30cm가 된다. 이 상황에서 케이크를 먹으면 3m 30cm가 된다."

이 이야기 에서

* 앨리스는 상태(앨리스의 키)를 가지며 상태는 변경 가능하다.

* 앨리스의 상태를 변경시키는 것은 앨리스의 행동이다. (자신의 상태는 자신의 행동이 변경한다.)

    * 행동의 결과는 상태에 의존적이며 상태를 이용해 서술할 수 있다.

    * 행동의 순서가 결과에 영향을 미친다. (150cm -> 150cm + 3m / 30cm -> 30cm + 3m)

* 앨리스는 어떤 상태에 있더라도 유일하게 식별 가능하다. (키가 작던 크던 엘리스다.)

# 객체, 그리고 소프트웨어 나라

객체의 다양한 특성을 효가적으로 설명하기 위해서는 객체를 **상태, 행동, 식별자**를 지닌 실체로 보는 것이 효가적이다.[Booch 2007]
```
객체란 식별 가능한 개체 또는 사물이다. 객체는 자동차처럼 만질 수 있는 구체적인 사물일 수도 있고, 시간처럼 추상적인 개념일 수도 있다. 객체는 구별 가능한 식별자, 특징적인 행동, 변경 가능한 상태를 가진다. 소프트웨어 안에서 객체는 저장된 상태와 실행 가능한 코드를 구현된다.
```

# 상태

## 왜 상태가 필요한가.

모든 일들의 공통점은 어떤 행동의 결과는 과거에 어떤행동들이 일어났느냐에 의존한다는 것이다. "텔레비전 전원을 켜지 않는 한 채널을 변경할 수 없다." "앨리스가 작은 문을 통과하기 위해서는 문을 통과하기 전에 음료를 마셔서 키를 줄여야 한다.". 일반적으로 과거에 발생한 행동의 이력을 통해 현재 발생한 행동의 결과를 판단하는 방식은 복잡하고 번거로우며 이해하기 어렵다. 따라서 인간은 행동의 과정과 단순하게 기술하기 위해 상태라는 개념을 고안했다. 상태를 이용하면 과거에 얽매이지 않고 현재를 기반으로 객체의 행동 방식을 이해할 수 있다.

## 상태와 프로퍼티

세상에 존재하는 모든 것들이 객체는 아니다. 객체는 상태를 지녀야한다. 숫자, 문자열, 양, 속도, 시간, 날짜, 참/거짓과 같은 단순한 값들은 객체가 아니다. 단순한 값들은 그 자체로 독립적인 의미를 갖기보다는 다른 객체의 특성을 표현하는데 사용된다.

객체의 상태를 표현할 때, 단순한 값이 아니라 객체를 사용해 다른 객체의 상태를 표현해야 할 떄가 있다. 앨리스가 음료를 들고있는 상태인지를 표현하고 싶다면 어떻게 해야할까? 앨리스의 상태 일부를 음료라는 객체를 이용해 표현하는 것이 방법이다. 앨리스 객체와 음료 객체는 연결되어 있다. ('들고있다'라는 연결사가 없는..)

결론적으로 객체의 상태는 단순한 값과 객체의 조합으로 표현할 수 있다. 상태를 구성하는 모든 특징을 **프로퍼티 property**라고 한다. 프로퍼티의 값을 **프로퍼티 벨류 property value**라고 한다. 프로퍼티는 정적이고 프로퍼티 벨류는 동적이다. 프로퍼티 벨류는 시간에 따라 변경되기 때문이다. 프로퍼티 벨류에도 종류가 있다. 단순한 *값*은 **속성 attribute**이라고 한다. 프로퍼티 벨류인 객체를 분류하는 용어는 없지만, 객체와 객체사이의 의미있는 연결은 링크라고 한다.

객체는 자율적이므로 연결되 있는 객체여도, 자신의 상태는 자신의 행동에 의해서만 변경되야한다.

# 행동

객체의 상태를 변경하는 것은 객체의 자발적인 행동 뿐이다. 객체의 행동은 객체의 상태를 변경하는 **부수효과 side effect**를 초래한다. 부수효과라는 용어는 행동이 상태를 변경하는 과정을 서술하기 적합하다. "앨리스가 케이크를 먹는다."는 행동은 앨리스의 키를 작게 변화 시키고, 케이크의 양을 줄인다.

그런데 행동의 결과는 객체의 상태의 의존적이다. 그래서 행동은 다음 두 가지 관점에서 서술할 수 있다.

* 상호작용이 현재의 상태에 어떻게 의존하는가
* 상호작용이 어떻게 현재의 상태를 변경시키는가
    * e.g. 엘리스의 키가 40센티미터 이하라면 문을 통과할 수 있다.
    * e.g. 문을 통과한 후에 엘리스의 위치는 아름다운 정원으로 바뀌어야 한다.

## 협력과 행동

객체는 자신에게 주어진 책임을 완수하기 위해 다른 객체를 이용한다. 즉, 협력에 참여한다. 객체의 행동은 다른 객체가 행동하게 한다. 협력 안에서 객체의 행동은 이 두가지 관점의 부수효과를 명확하게 서술해야한다.

* 객체 자신의 상태 변경
* 행동 내에서 협력하는 다른 객체에 대한 메시지 전송

행동이란

```
행동이란 외부의 요청 또는 수신된 메시지에 응답하기 위해 동작하고 반응하는 활동이다. 행동의 결과로 객체는 자신의 상태를 변경하거나 다른 객체에게 메시지를 전달할 수 있다. 객체는 행동을 통해 다른 객체와 협력에 참여하므로 행동은 외부에 가시적이어야 한다.
```

## 상태 캡슐화

캡슐화는 객체의 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않는 것이다. 캡슐화는 객체의 자율성을 높이는 것이다.

높은 객체의 자율성은 협력을 단순하고 유연하게 만든다. 자율적인 객체는 스스로 판단하고 스스로 결정하기 때문이다.

# 식별자

객체가 식별 가능하다는 것은 객체를 서로 구별할 수 있는 특정한 프로퍼티가 객체안에 존재하는 것. 이 프로퍼티를 식별자라고 한다. 모든 객체는 식별자를 가지며 식별자를 이용해 객체를 구별할 수 있다.

값과 객체의 가장큰 다른 점은 값은 식별자가 없지만, 객체는 식별자가 있다는 것이다.

값(value)는 불변 상태를 갖는다. 10은 언제나 10이다.

객체는 시간에 따라 변경되는 상태를 포함한다. 가변 상태(mutable state)를 갖는다. 타입이 같은 두 객체의 상태가 완전히 똑같더라도 두 객체는 독립적인 별개의 객체로 다뤄야 한다. 복제인간과 인간이 이름, 키 등의 상태가 같아도 별개의 인격체인 것처럼, 객체는 식별자를 기반으로 구분된다. 상태가 다르더라도 식별자가 같다면 두 객체는 같은 객체로 판단할 수 있다. 식별자를 기반으로 객체가 같은지를 판단할 수 있는 성질을 동일성(identical)이라고 한다.

**참조 객체(reference object)**, 또는 **엔티티(entity)**는 식별자를 지닌 전통적인 의미의 객체를 가리키는 용어다. **값 객체(value object)**는 식별자를 가지지 않는 값을 가리키는 용어다.

### overall

* 객체는 상태를 가지며 상태는 변경 가능하다.
* 객체의 상태를 변경시키는 것은 객체의 행동이다.
    * 행동의 결과는 상태에 의존적이며 상태를 이용해 서술할 수 있다.
    * 행동의 순서가 행동 실행 결과에 영향을 미친다.
* 객체는 어떤 상태에 있더라도 유일하게 식별 가능하다.

# 기계로서의 객체

**개인 적으로 이 그림이 전체적인 객체의 협력을 이해하고 그려네는데 가장 유용했다**

![기계로서의 객체]({{site.url}}/assets/post_images/object-as-machine.png )

기계는 현재 상태를 갖는다. 볼륨: 10 상태에서, 볼륨 업 버튼을 누르면 볼륨: 12로 변경되고 소리가 커진다. 연결된 기계는 협력하는 객체다. 기계 앞쪽의 전원 종료 버튼은, 사실 뒤에 숨겨진 작은 기계에게 전원 종료 메시지를 전송해, 전원을 담당하는 작은 기계가 이를 수행한다.


# 행동이 상태를 결정한다.

객체를 상태를 중심으로 바라보고 객체를 만들기 시작하면
1. 캡슐화가 저해된다.

    상태를 먼저 구상하니, 어떤 함수가 private/public인지, 또는 private/public에 맞게 구현하지 못할 확률이 높다.

2. 객체를 협력하지 못하게 고립시킨다.

    협력 이라는 문맥에서 멀리 벗어난 채 설계하기 때문이다.

3. 객체의 재사용성이 저하된다.

    객체의 재사용성은 다양한 협력에 참여할 수 있는 능력에서 나온다. 2.의 이유로 재사용성이 저하된다.

그래서! **행동이 상태를 결정한다.**
객체지향 설계는 **어플리케이션에 필요한 협력을 생각하고 협력에 참여하는데 필요한 행동을 생각한 후 수행할 객체를 선택하는 방식으로 수행 된다.**
책임-주도 설계(RDD)는 어떤 책임이 필요한가를 결정하는 과정이 설계를 주도해야 한다는 설계 방법론이다.


p.69

TODO
현실세계와 객체지향 세계 사이의 관계를 좀 더 정확하게 설명할 수 있는 단어는 은유(metaphor)다.[Noble 2002]
표현적 차이(representational gap) 의미적 차이(semantic gap) [Larman 2003]

